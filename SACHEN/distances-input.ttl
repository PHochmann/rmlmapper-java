@prefix rr: <http://www.w3.org/ns/r2rml#>.
@prefix rml: <http://semweb.mmlab.be/ns/rml#>.
@prefix ql: <http://semweb.mmlab.be/ns/ql#>.
@prefix xsd: <http://www.w3.org/2001/XMLSchema#>.
@prefix schema: <http://schema.org/>.

@prefix ifcrml: <http://ifcrml.thisisnourl/ifcrml#>.
@prefix fno: <https://w3id.org/function/ontology#> .
@prefix fnom: <https://w3id.org/function/vocabulary/mapping#> .
@prefix fnoi: <https://w3id.org/function/vocabulary/implementation#> .
@prefix ex: <http://example.com#>.

@base <http://example.com/ns#>.

# PROBLEM DEFINITION BELOW  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

ex:IFCDistanceFilter a fno:Function ;
    fno:expects ( ex:intParamA ex:intParamB ex:intParamC ex:intParamD ex:intParamE ex:intParamF ex:intParamG ) .

ex:intParamA a fno:Parameter;
    fno:predicate ex:boxX ;
    fno:type xsd:integer ;
    fno:required "true"^^xsd:boolean .

ex:intParamB a fno:Parameter;
    fno:predicate ex:boxY ;
    fno:type xsd:integer ;
    fno:required "true"^^xsd:boolean .

ex:intParamC a fno:Parameter;
    fno:predicate ex:boxZ ;
    fno:type xsd:integer ;
    fno:required "true"^^xsd:boolean .

ex:intParamD a fno:Parameter;
    fno:predicate ex:boxWidth ;
    fno:type xsd:integer ;
    fno:required "true"^^xsd:boolean .

ex:intParamE a fno:Parameter;
    fno:predicate ex:boxHeight ;
    fno:type xsd:integer ;
    fno:required "true"^^xsd:boolean .

ex:intParamF a fno:Parameter;
    fno:predicate ex:boxDepth ;
    fno:type xsd:integer ;
    fno:required "true"^^xsd:boolean .

ex:intParamG a fno:Parameter;
    fno:predicate ex:minDistance ;
    fno:type xsd:integer ;
    fno:required "true"^^xsd:boolean .

ex:distanceFilterExecution
    a              fno:Execution ;
    fno:executes   ex:IFCDistanceFilter ;
    ex:boxX        0^^xsd:integer ;
    ex:boxY        1^^xsd:integer ;
    ex:boxZ        2^^xsd:integer ;
    ex:boxWidth    3^^xsd:integer ;
    ex:boxHeight   4^^xsd:integer ;
    ex:boxDepth    5^^xsd:integer ;
    ex:minDistance 6^^xsd:integer .

ex:IFCFilters
    a                  fnoi:JavaClass ;
    #doap:download-page "GrelFunctions.jar" ;
    fnoi:class-name    "be.ugent.rml.functions.ExecutionParser" .

ex:distanceFilterMapping
    a                 fno:Mapping ;
    fno:implementation ex:IFCFilters ;
    fno:methodMapping [ a                fnom:StringMethodMapping ;
                        fnom:method-name "filterEntitiesFromBoxDistance" ] .


# RML MAPPING BELOW  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

<#IFCMapping> a rr:TriplesMap;
  rml:logicalSource [

    rml:source [
      rdf:type ifcrml:ifc ;
      ifcrml:serverLocation "http://localhost:8082" ;
      ifcrml:password "123456" ;
      ifcrml:username "admin@admin.com" ;
      ifcrml:path "SACHEN/test-small.ifc" ;
      ifcrml:format "ifc2x3tc1"
    ];

    rml:referenceFormulation ifcrml:IFCAttribute ;

    #ifcrml:iterator """{
    #  "type": {
    #    "name": "IfcProduct",
    #    "includeAllSubTypes": "true"
    #  }
    #}"""

    ifcrml:iteratorMapping ex:distanceFilterMapping ;
    ifcrml:iteratorExecution ex:distanceFilterExecution
  ];

  rr:subjectMap [
    rr:template "http://example.com/{IfcType}/{GlobalId}";
  ];

  rr:predicateObjectMap [
  rr:predicate rdf:type;
  rr:objectMap [
    rr:template "https://standards.buildingsmart.org/IFC/DEV/IFC2x3/FINAL/OWL#{IfcType}"
    ]
  ].
  