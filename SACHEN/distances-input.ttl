@prefix rr: <http://www.w3.org/ns/r2rml#>.
@prefix rml: <http://semweb.mmlab.be/ns/rml#>.
@prefix ql: <http://semweb.mmlab.be/ns/ql#>.
@prefix xsd: <http://www.w3.org/2001/XMLSchema#>.
@prefix schema: <http://schema.org/>.

@prefix ifcrml: <http://ifcrml.thisisnourl/ifcrml#>.
@prefix fno: <https://w3id.org/function/ontology#> .
@prefix fnom: <https://w3id.org/function/vocabulary/mapping#> .
@prefix fnoi: <https://w3id.org/function/vocabulary/implementation#> .
@prefix ex: <http://example.com#>.

@base <http://example.com/ns#>.

# PROBLEM DEFINITION BELOW  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

ex:IFCDistanceFilter a fno:Function ;
    fno:expects ( ex:stringParamA ex:intParamA ) .

ex:intParamA a fno:Parameter ;
    fno:predicate ex:minDistance ;
    fno:type xsd:integer ;
    fno:required "true"^^xsd:boolean .

ex:stringParamA a fno:Parameter ;
    fno:predicate ex:boxId ;
    fno:type xsd:string ;
    fno:required "true"^^xsd:boolean .

ex:distanceFilterExecution
    a              fno:Execution ;
    fno:executes   ex:IFCDistanceFilter ;
    ex:boxId       "0Eg7c0qrDCPxnT5bQp4tqX"^^xsd:string ;
    ex:minDistance "100000"^^xsd:integer .

ex:IFCFilters
    a                  fnoi:JavaClass ;
    #doap:download-page "GrelFunctions.jar" ;
    fnoi:class-name    "be.ugent.rml.functions.ExecutionParser" .

ex:distanceFilterMapping
    a                 fno:Mapping ;
    fno:implementation ex:IFCFilters ;
    fno:methodMapping [ a                fnom:StringMethodMapping ;
                        fnom:method-name "filterEntitiesFromBoxDistance" ] .


# RML MAPPING BELOW  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

<#IFCMapping> a rr:TriplesMap;
  rml:logicalSource [

    rml:source [
      rdf:type ifcrml:ifc ;
      ifcrml:serverLocation "http://localhost:8082" ;
      ifcrml:password "123456" ;
      ifcrml:username "admin@admin.com" ;
      ifcrml:path "SACHEN/test-openings.ifc" ;
      ifcrml:format "ifc2x3tc1" ;
      ifcrml:geometry "true"^^xsd:boolean
    ];

    rml:referenceFormulation ifcrml:IFCAttribute ;

    #ifcrml:iterator """{
    #  "type": {
    #    "name": "IfcWallStandardCase",
    #    "includeAllSubTypes": "true"
    #  }
    #}"""

    ifcrml:iteratorMapping ex:distanceFilterMapping ;
    ifcrml:iteratorExecution ex:distanceFilterExecution
  ];

  rr:subjectMap [
    rr:template "http://example.com/{IfcType}/{GlobalId}";
  ];

  rr:predicateObjectMap [
  rr:predicate rdf:type;
  rr:objectMap [
    rr:template "https://standards.buildingsmart.org/IFC/DEV/IFC2x3/FINAL/OWL#{IfcType}"
    ]
  ].
  